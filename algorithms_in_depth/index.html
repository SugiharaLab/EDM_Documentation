<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>EDM Algorithms in Depth - EDM (pyEDM, rEDM)</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../extra.css" rel="stylesheet" />
  <link href="../css/ansi-colours.css" rel="stylesheet" />
  <link href="../css/jupyter-cells.css" rel="stylesheet" />
  <link href="../css/pandas-dataframe.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "EDM Algorithms in Depth";
    var mkdocs_page_input_path = "algorithms_in_depth.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> EDM (pyEDM, rEDM)</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edm_intro/">EDM Framework</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../embedding_parameters/">Embedding</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../parameters/">Parameters</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../edm_functions/">EDM Functions</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">EDM Algorithms</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../algorithms_high_level/">Basic EDM Examples</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">EDM Algorithms in Depth</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#simplex-nearest-neighbor-projection">Simplex : Nearest Neighbor Projection</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#s-map-sequential-locally-weighted-global-linear-maps">S-Map : Sequential Locally Weighted Global Linear Maps</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ccm-convergent-cross-mapping">CCM : Convergent Cross Mapping</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../solvers_demo/">Custom Solvers</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">EDM (pyEDM, rEDM)</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>EDM Algorithms &raquo;</li>
        
      
    
    <li>EDM Algorithms in Depth</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="edm-algorithms">EDM Algorithms</h1>
<h2 id="simplex-nearest-neighbor-projection">Simplex : Nearest Neighbor Projection</h2>
<p><code>Simplex</code> is a nearest neighbor projection. It locates the <code>knn</code> 
nearest neighbors to the query point (location in the state-space from
which a prediction is desired) within the library phase-space. <code>knn</code> is
typically set to <code>E</code>+1, where <code>E</code> is the system dimension.  These <code>knn</code>
points define an <code>E</code>+1 dimensional simplex in the state-space.  The
prediction is computed as the average of the weighted phase-space simplex
projected <code>Tp</code> points ahead.  Each neighbor is weighted
proportional to their distance to the query point as described in
<a href="https://www.nature.com/articles/344734a0">Sugihara and May 1990</a>.
<code>Simplex</code> is the most direct projection technique in the
EDM package, operates with minimal assumptions, and is the core algorithm
for the evaluation of embedding dimension
<a href="../edm_functions/#embeddimension"><code>EmbedDimension()</code></a>, evaluation of
temporal forecast predictability
<a href="../edm_functions/#predictinterval"><code>PredictInterval()</code></a>, 
convergent cross mapping <a href="../edm_functions/#ccm"><code>CCM()</code></a>,
and multiview embedding <a href="../edm_functions/#multiview"><code>Multiview()</code></a>.</p>
<h2 id="s-map-sequential-locally-weighted-global-linear-maps">S-Map : Sequential Locally Weighted Global Linear Maps</h2>
<p>S-Map extends the phase space prediction in <code>Simplex</code> from an
average of the <code>E</code>+1 knn neighbors, to a linear regression fit to all
neighbors, but localised with an exponential decay kernel as described
in <a href="https://royalsocietypublishing.org/doi/abs/10.1098/rsta.1994.0106">Sugihara 1994</a>. The exponential localisation function is F(θ) = exp(-θd/D), where d
is the neighbor distance and D the mean distance.
In this way, neighbors close to the query point have a higher weight
than those further from it, such that a locally linear approximation to
the nonlinear system is reasonable. This <em>localisation</em> ability allows
one to identify an optimal local scale that may provide improved
predictability over a <code>Simplex</code> projection. </p>
<p>For a demonstration of this localisation, see the
<a href="https://github.com/cameronosmith/EDM_notebooks/blob/master/SMAP.ipynb">S-MAP Notebook</a>.</p>
<p>Another advantage of S-Map is that for a properly fit model, the regression
coefficients between variables have been shown to approximate
the gradient (directional derivative) of variables along the manifold
(<a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2015.2258">Deyle et al. 2016</a>). These Jacobians represent the time-varying interaction strengths
between system variables. </p>
<h2 id="ccm-convergent-cross-mapping">CCM : Convergent Cross Mapping</h2>
<p>One of the corollaries to the Generalized Takens Theorem is that it
should be possible to cross predict or cross map between variables that
are observed from the same system. Suppose that in some dynamical system
involving variables <em>X</em> and <em>Y</em>, <em>X</em> causes <em>Y</em>. 
Since <em>X</em> and <em>Y</em> belong to the same dynamical system, their reconstructions
(via embeddings) <em>Mx</em>, and <em>My</em>, also map to the same system.</p>
<p>The causal variable <em>X</em> leaves a signature on the affected variable <em>Y</em>,
and consequently, the reconstructed states based on <em>Y</em> can be used to
cross predict the values of <em>X</em>. CCM leverages this property to infer
causality by predicting <em>X</em> using <em>My</em>'s library of points (or vice versa
for the other direction of causality), while assessing improvements in
cross map predictability as larger and larger random samplings of <em>My</em>
are used. If the prediction skill of <em>X</em> increases and saturates as the
entire <em>My</em> is used, this provides evidence that <em>X</em> is casually
influencing <em>Y</em> as described in
<a href="https://science.sciencemag.org/content/338/6106/496">Sugihara et al. 2012</a>.</p>
<iframe width="100%" height="335" src="https://www.youtube.com/embed/NrFdIz-D2yM" 
frameborder="0" allow="autoplay; gyroscope; picture-in-picture" allowfullscreen></iframe>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../solvers_demo/" class="btn btn-neutral float-right" title="Custom Solvers">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../algorithms_high_level/" class="btn btn-neutral" title="Basic EDM Examples"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../algorithms_high_level/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../solvers_demo/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
