<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>EDM Algorithms in Depth - EDM (pyEDM, rEDM)</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "EDM Algorithms in Depth";
    var mkdocs_page_input_path = "algorithms_in_depth.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> EDM (pyEDM, rEDM)</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../installation/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../edm_intro/">EDM Framework</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Documentation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../edm_functions/">EDM Functions</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">EDM Algorithms</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../algorithms_high_level/">Examples</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">EDM Algorithms in Depth</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#edm-algorithms">EDM Algorithms</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#simplex-nearest-neighbor-projection">Simplex : Nearest Neighbor Projection</a></li>
        
            <li><a class="toctree-l4" href="#s-map-sequential-locally-weighted-global-linear-maps">S-Map : Sequential Locally Weighted Global Linear Maps</a></li>
        
            <li><a class="toctree-l4" href="#ccm-convergent-cross-mapping">CCM : Convergent Cross Mapping</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">EDM (pyEDM, rEDM)</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>EDM Algorithms &raquo;</li>
        
      
    
    <li>EDM Algorithms in Depth</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="edm-algorithms">EDM Algorithms</h1>
<h2 id="simplex-nearest-neighbor-projection">Simplex : Nearest Neighbor Projection</h2>
<p>The <code>Simplex</code> algorithm is a nearest neighbor projection. It collects the <code>knn</code> 
nearest points to the query point in phase space, then calculates the prediction 
as the normalized weighted trajectory of each neighbor, each neighbor contributing 
to the prediction proportional to their distance to the query point.
It is a simple prediction algorithm typically used to quickly estimate how much
information the attractor has for predicting a variable.<br />
The images below illustrate the algorithm:
<img alt="highlighted neighbors" src="../imgs/nearest_neighbors.png" />
<img alt="highlighted neighbors projection" src="../imgs/nearest_neighbors_projected.png" /></p>
<p>Note: the plots for the Simplex reconstruction were taken from the 
<a href="https://mathbio.github.io/edmTutorials/">mathbio tutorial</a> on the EDM algorithms.</p>
<h2 id="s-map-sequential-locally-weighted-global-linear-maps">S-Map : Sequential Locally Weighted Global Linear Maps</h2>
<p>See the link to the exported jupyter notebook below on the S-Map algorithm:<br />
Jupyter notebook: <a href="https://github.com/cameronosmith/EDM_notebooks/blob/master/SMAP.ipynb">S-MAP Notebook </a>   </p>
<p>tldr: For every query point, S-MAP constructs a linear function from all 
state-space neighbors. However, each neighbor is weighted with an exponential 
function based on theta, such that nearby points to the query point 
have a higher weight than those further from it, such that a locally linear 
approximation to the nonlinear system of study is appropriate (as long as theta 
is weighted proportionately to how nonlinear the system is). Hopefully it makes sense now 
why SMAP stands for sequentially weighted global linear maps, since the algorithm: 
for every query point (sequentially) weights the entire library (weighted global) 
and then computes a linear solution mapping the local space on the reconstructed 
attractor to the space of the target variable (linear maps).</p>
<h2 id="ccm-convergent-cross-mapping">CCM : Convergent Cross Mapping</h2>
<iframe width="100%" height="335" src="https://www.youtube.com/embed/NrFdIz-D2yM" 
frameborder="0" allow="autoplay; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Suppose that in some dynamical system involving variables X and Y, X causes Y 
(if you were trying to define Y as an explicit function, X would be a term in this 
equation).<br />
Takens' Theorem suggests that because X and Y belong to the same dynamical system, their
reconstructions (via embeddings) Mx and My map to the same system, and so Mx and My 
should map to each other as well. CCM leverages this property to detect causality 
by predicting X using My's library of points (or vice versa for other direction of 
causality).
The intuition is that if X causes Y, then there should be some artifact of X 
embedded in Y that we can extract by performing state space reconstruction on Y, 
and approximate how much X drives Y by how well Simplex can predict X from My's 
attractor. The prediction is performed via Simplex, using My's library to search 
for the nearest neighbors to a query point in X, and measuring the correlation 
between X predicted from My and X.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../algorithms_high_level/" class="btn btn-neutral" title="Examples"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../algorithms_high_level/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
