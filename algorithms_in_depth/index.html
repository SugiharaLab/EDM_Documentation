<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>EDM Algorithms in Depth - pyEDM, rEDM</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
        <link href="../css/ansi-colours.css" rel="stylesheet" />
        <link href="../css/jupyter-cells.css" rel="stylesheet" />
        <link href="../css/pandas-dataframe.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "EDM Algorithms in Depth";
        var mkdocs_page_input_path = "algorithms_in_depth.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> pyEDM, rEDM
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../edm_intro/">EDM Framework</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Documentation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../edm_functions/">API Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parameters/">Parameters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedding_parameters/">Embedding</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simplex_/">Simplex</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../smap_/">SMap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ccm_/">CCM</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multiview_/">Multiview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedDimension_/">EmbedDimension</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../predictInterval_/">PredictInterval</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../predictNonlinear_/">PredictNonlinear</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embed_/">Embed</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../makeBlock_/">MakeBlock</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../computeError_/">ComputeError</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic_examples/">Basic EDM Examples</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">EDM Algorithms</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">EDM Algorithms in Depth</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#simplex-nearest-neighbor-projection">Simplex : Nearest Neighbor Projection</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#video-of-simplex-prediction-at-varying-library-sizes">Video of Simplex prediction at varying library sizes</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#s-map-sequential-locally-weighted-global-linear-maps">S-Map : Sequential Locally Weighted Global Linear Maps</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#video-of-s-map-prediction-at-varying-theta">Video of S-Map prediction at varying theta</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#s-map-interaction-coefficients">S-Map Interaction Coefficients</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ccm-convergent-cross-mapping">CCM : Convergent Cross Mapping</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SMap_Demo/">S-map First Principles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../solvers_demo/">S-map Custom Solvers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cond_emb_demo/">Conditional Embedding</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">pyEDM, rEDM</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>EDM Algorithms &raquo;</li>
      <li>EDM Algorithms in Depth</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div><h1 id="edm-algorithms">EDM Algorithms</h1>
<h2 id="simplex-nearest-neighbor-projection">Simplex : Nearest Neighbor Projection</h2>
<p><code>Simplex</code> is a nearest neighbor projection. It locates the <code>knn</code> 
nearest neighbors to the query point (location in the state-space from
which a prediction is desired) within the library state-space. <code>knn</code> is
typically set to <code>E</code>+1, where <code>E</code> is the system dimension.  These <code>knn</code>
points define an <code>E</code>+1 dimensional simplex in the state-space.</p>
<p>The prediction is computed as the average of the weighted state-space simplex
projected <code>Tp</code> points ahead.  Each neighbor is weighted
proportional to their distance to the query point as described in
<a href="https://www.nature.com/articles/344734a0">Sugihara and May 1990</a>.</p>
<p><code>Simplex</code> is the most direct projection technique in the
EDM package, operates with minimal assumptions, and is the core algorithm
for the evaluation of embedding dimension
<a href="../edm_functions/#embeddimension"><code>EmbedDimension()</code></a>, evaluation of
temporal forecast predictability
<a href="../edm_functions/#predictinterval"><code>PredictInterval()</code></a>, 
convergent cross mapping <a href="../edm_functions/#ccm"><code>CCM()</code></a>,
and multiview embedding <a href="../edm_functions/#multiview"><code>Multiview()</code></a>.</p>
<h3 id="video-of-simplex-prediction-at-varying-library-sizes">Video of Simplex prediction at varying library sizes</h3>
<p>This video illustrates how denser state space representations with increasing
number of library vectors improves Simplex prediction.</p>
<p><div class="video-container"><video style="width:75%" muted controls alt="type:video"><source src="../imgs/TentMap_Library.mp4" type="video/mp4"></source></video></div><br></p>
<h2 id="s-map-sequential-locally-weighted-global-linear-maps">S-Map : Sequential Locally Weighted Global Linear Maps</h2>
<p>S-Map extends the state-space prediction in <code>Simplex</code> from an
average of the <code>E</code>+1 knn neighbors, to a linear regression fit to all
neighbors, but localized with an exponential decay kernel as described
in <a href="https://royalsocietypublishing.org/doi/abs/10.1098/rsta.1994.0106">Sugihara 1994</a>. The exponential localization function is F(θ) = exp(-θd/D), where d
is the neighbor distance, D the mean distance and θ the localization parameter.
This kernel weights neighbors close to the query point (neighbors in similar
dynamical states) with higher weight than those further from it such that a 
local linear approximation to the nonlinear system can be reasonable. 
This <em>localization</em> ability allows one to identify an optimal local scale that
best represents local dynamics. As a result, assessing predictability
over a spectrum of localization parameters θ allows one to infer
state-dependence, and thus nonlinearity of the dynamics. See 
<a href="../edm_functions/#predictnonlinear"><code>PredictNonlinear()</code></a>.</p>
<h3 id="video-of-s-map-prediction-at-varying-theta">Video of S-Map prediction at varying theta</h3>
<p>This video illustrates S-Map predictions with increasing values (higher localization) of <code>theta</code>.</p>
<p><div class="video-container"><video style="width:75%" muted controls alt="type:video"><source src="../imgs/Rossler_Theta.mp4" type="video/mp4"></source></video></div><br></p>
<p>For a first-principles exploration of S-Map state-space localization, see the
<a href="../SMap_Demo/">S-Map Notebook</a>.</p>
<h3 id="s-map-interaction-coefficients">S-Map Interaction Coefficients</h3>
<p>Another feature of S-Map is that for a properly fit model, the regression
coefficients between variables have been shown to approximate
the gradient (directional derivative) of variables along the manifold
(<a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2015.2258">Deyle et al. 2016</a>). These Jacobians represent the time-varying interaction strengths
between system variables. </p>
<h2 id="ccm-convergent-cross-mapping">CCM : Convergent Cross Mapping</h2>
<p>One of the corollaries to the Generalized Takens Theorem is that it
should be possible to cross predict or cross map between variables that
are observed from the same system. Suppose that in some dynamical system
involving variables <em>X</em> and <em>Y</em>, <em>X</em> causes <em>Y</em>. 
Since <em>X</em> and <em>Y</em> belong to the same dynamical system, their reconstructions
(via embeddings) <em>Mx</em>, and <em>My</em>, also map to the same system.</p>
<p>The causal variable <em>X</em> leaves a signature on the affected variable <em>Y</em>,
and consequently, the reconstructed states based on <em>Y</em> can be used to
cross predict the values of <em>X</em>. CCM leverages this property to infer
causality by predicting <em>X</em> using <em>My</em>'s library of points (or vice versa
for the other direction of causality), while assessing improvements in
cross map predictability as larger and larger random samplings of <em>My</em>
are used. If the prediction skill of <em>X</em> increases and saturates as the
entire <em>My</em> is used, this provides evidence that <em>X</em> is casually
influencing <em>Y</em> as described in
<a href="https://science.sciencemag.org/content/338/6106/496">Sugihara et al. 2012</a>.</p>
<iframe width="100%" height="335" src="https://www.youtube.com/embed/NrFdIz-D2yM" frameborder="0" allow="autoplay; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../basic_examples/" class="btn btn-neutral float-left" title="Basic EDM Examples"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../SMap_Demo/" class="btn btn-neutral float-right" title="S-map First Principles">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../basic_examples/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../SMap_Demo/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
